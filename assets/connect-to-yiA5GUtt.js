import{R as u,c as g,u as h,o as f,a as m,b as S,d as w,e as o,M as c,t as s,S as R}from"./index-DDRkUl0Q.js";var C=s("<div>Connecting..."),M=s("<div>Waiting for data..."),P=s("<div>Data received!");function q(){const t=u.useSearch({select:e=>e.connectionId}),n=u.useSearch({select:e=>e.peerId}),[r,a]=g(),i=h();f(()=>{a("connecting"),console.log("connect-to: adding peer (onMount)",{peerId:n(),connectionId:t()}),i.addNewPeer(n()),a("waiting-for-data");const e=()=>(console.log("connect-to: sending request-storage",{peerId:n(),connectionId:t()}),i.sendToPeer(n(),{type:"request-storage",data:{connectionId:t()}}));e();const d=setInterval(()=>{if(r()==="received-data"){clearInterval(d);return}e()},1e3);return()=>clearInterval(d)});const l=m(),p=S(),[v,I]=g(!1);return w(()=>{v()||p.store.connections.find(e=>e.id===t())&&(a("received-data"),I(!0),console.log("connect-to: received data, navigating",{connectionId:t()}),l.navigate({to:"/wheel/$connectionId",params:{connectionId:t()}}))}),o(R,{get children(){return[o(c,{get when(){return r()==="connecting"},get children(){return C()}}),o(c,{get when(){return r()==="waiting-for-data"},get children(){return M()}}),o(c,{get when(){return r()==="received-data"},get children(){return P()}})]}})}export{q as component};
