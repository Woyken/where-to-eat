import{R as g,c as p,u as I,o as C,a as y,b as w,d as $,t as r,i as v,e as t,C as b,f as _,g as S,S as R,M as c,h as k}from"./index-DrMF0ifk.js";var M=r("<span aria-hidden=true>ðŸ”—"),P=r('<div class=space-y-2><div class="font-display text-xl font-semibold tracking-tight">Connectingâ€¦</div><div class="text-sm text-muted-foreground">Finding your peer and opening a secure sync channel.'),q=r('<div class=space-y-2><div class="font-display text-xl font-semibold tracking-tight">Waiting for dataâ€¦</div><div class="text-sm text-muted-foreground">Hold tight â€” the wheel is being transferred.'),H=r('<div class=space-y-2><div class="font-display text-xl font-semibold tracking-tight">Data received!</div><div class="text-sm text-muted-foreground">Redirecting you to the wheel.'),N=r('<div class="mt-5 rounded-2xl border border-border bg-card/40 p-3 text-xs text-muted-foreground"><div class="font-mono break-all">connectionId: '),T=r('<div class="py-12 sm:py-16"><div class="mx-auto max-w-md">');function E(){const n=g.useSearch({select:e=>e.connectionId}),a=g.useSearch({select:e=>e.peerId}),[s,i]=p(),d=I();C(()=>{i("connecting"),console.log("connect-to: adding peer (onMount)",{peerId:a(),connectionId:n()}),d.addNewPeer(a()),i("waiting-for-data");const e=()=>(console.log("connect-to: sending request-storage",{peerId:a(),connectionId:n()}),d.sendToPeer(a(),{type:"request-storage",data:{connectionId:n()}}));e();const o=setInterval(()=>{if(s()==="received-data"){clearInterval(o);return}e()},1e3);return()=>clearInterval(o)});const h=y(),m=w(),[f,x]=p(!1);return $(()=>{f()||m.store.connections.find(e=>e.id===n())&&(i("received-data"),x(!0),console.log("connect-to: received data, navigating",{connectionId:n()}),h.navigate({to:"/wheel/$connectionId",params:{connectionId:n()}}))}),(()=>{var e=T(),o=e.firstChild;return v(o,t(k,{class:"animate-paper-rise",get children(){return[t(b,{get children(){return t(_,{class:"flex items-center gap-2",get children(){return[M(),"Join Connection"]}})}}),t(S,{get children(){return[t(R,{get children(){return[t(c,{get when(){return s()==="connecting"},get children(){return P()}}),t(c,{get when(){return s()==="waiting-for-data"},get children(){return q()}}),t(c,{get when(){return s()==="received-data"},get children(){return H()}})]}}),(()=>{var l=N(),u=l.firstChild;return u.firstChild,v(u,n,null),l})()]}})]}})),e})()}export{E as component};
